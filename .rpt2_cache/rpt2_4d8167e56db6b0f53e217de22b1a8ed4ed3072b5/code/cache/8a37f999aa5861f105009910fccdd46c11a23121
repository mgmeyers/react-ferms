{"code":"import * as tslib_1 from \"tslib\";\r\nimport * as prop from 'prop-ops';\r\nimport FormField from 'data/FormField';\r\nimport { sanitizeKey } from 'helpers';\r\nimport defaultValidationStrat from 'validation-strategies/default';\r\nimport { FormStatus, } from 'types';\r\nvar FormFields = /** @class */ (function () {\r\n    function FormFields(opts) {\r\n        this.options = {\r\n            defaults: opts.defaults || {},\r\n            fields: opts.fields || {},\r\n            validateOn: opts.validateOn || 'submit',\r\n            validationStrategy: opts.validationStrategy || defaultValidationStrat,\r\n        };\r\n    }\r\n    FormFields.prototype.add = function (opts) {\r\n        if (opts.multiple && this.getField(opts.key) !== undefined) {\r\n            return this;\r\n        }\r\n        var status = !opts.value ? FormStatus.PRISTINE : FormStatus.DIRTY;\r\n        var globalOpts = this.options;\r\n        var field = new FormField({\r\n            defaultValidateOn: globalOpts.validateOn,\r\n            key: opts.key,\r\n            multiple: opts.multiple,\r\n            status: status,\r\n            transform: opts.transform,\r\n            validate: opts.validate,\r\n            validateOn: opts.validateOn,\r\n            validationStrategy: globalOpts.validationStrategy,\r\n            value: opts.value || prop.get(globalOpts.defaults, opts.key, ''),\r\n        });\r\n        return this.update(opts.key, field);\r\n    };\r\n    FormFields.prototype.remove = function (key) {\r\n        var options = this.options;\r\n        return new FormFields(prop.set(options, 'fields', prop.del(options.fields, sanitizeKey(key))));\r\n    };\r\n    FormFields.prototype.validate = function () {\r\n        var currentFields = this.options.fields;\r\n        var valid = true;\r\n        var fields = Object.keys(currentFields).reduce(function (newFields, key) {\r\n            var result = currentFields[key].validate();\r\n            if (!result.valid) {\r\n                valid = false;\r\n            }\r\n            newFields[key] = result.field;\r\n            return newFields;\r\n        }, {});\r\n        return {\r\n            fields: new FormFields(prop.set(this.options, 'fields', fields)),\r\n            valid: valid,\r\n        };\r\n    };\r\n    FormFields.prototype.validateField = function (key) {\r\n        var result = this.getField(key).validate();\r\n        return {\r\n            fields: this.update(key, result.field),\r\n            valid: result.valid,\r\n        };\r\n    };\r\n    FormFields.prototype.getField = function (key) {\r\n        var fieldKey = sanitizeKey(key);\r\n        return this.options.fields[fieldKey];\r\n    };\r\n    Object.defineProperty(FormFields.prototype, \"values\", {\r\n        get: function () {\r\n            var fields = this.options.fields;\r\n            return Object.keys(fields).reduce(function (values, key) {\r\n                var field = fields[key];\r\n                return prop.set(values, field.key, field.value, true);\r\n            }, {});\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FormFields.prototype, \"status\", {\r\n        get: function () {\r\n            var fields = this.options.fields;\r\n            return Object.keys(fields).reduce(function (status, key) {\r\n                return Math.max(status, fields[key].status);\r\n            }, 0);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FormFields.prototype, \"errors\", {\r\n        get: function () {\r\n            var fields = this.options.fields;\r\n            return Object.keys(fields).reduce(function (errs, key) {\r\n                var field = fields[key];\r\n                var errors = field.errors;\r\n                return errors.length > 0\r\n                    ? prop.set(errs, field.key, field.errors, true)\r\n                    : errs;\r\n            }, {});\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FormFields.prototype.setValue = function (key, value) {\r\n        var field = this.getField(key).setValue(value);\r\n        return this.update(key, field);\r\n    };\r\n    FormFields.prototype.setTransform = function (key, transformFn) {\r\n        var field = this.getField(key).setTransform(transformFn);\r\n        return this.update(key, field);\r\n    };\r\n    FormFields.prototype.setValidation = function (key, validation) {\r\n        var field = this.getField(key).setValidate(validation);\r\n        return this.update(key, field);\r\n    };\r\n    FormFields.prototype.setValidateOn = function (key, on) {\r\n        var field = this.getField(key).setValidateOn(on);\r\n        return this.update(key, field);\r\n    };\r\n    FormFields.prototype.setValidationStrategy = function (validationStrategy) {\r\n        var strat = validationStrategy || defaultValidationStrat;\r\n        var currentFields = this.options.fields;\r\n        var fields = Object.keys(currentFields).reduce(function (newFields, key) {\r\n            var f = currentFields[key];\r\n            return prop.set.mutate(newFields, key, f.setValidationStrategy(strat));\r\n        }, {});\r\n        return new FormFields(tslib_1.__assign({}, this.options, { fields: fields, validationStrategy: strat }));\r\n    };\r\n    FormFields.prototype.setDefaultValidateOn = function (validateOn) {\r\n        var currentFields = this.options.fields;\r\n        var on = validateOn || 'submit';\r\n        var fields = Object.keys(currentFields).reduce(function (newFields, key) {\r\n            var f = currentFields[key];\r\n            return prop.set.mutate(newFields, key, f.setDefaultValidateOn(on));\r\n        }, {});\r\n        return new FormFields(tslib_1.__assign({}, this.options, { validateOn: on, fields: fields }));\r\n    };\r\n    FormFields.prototype.setDefaults = function (defaults) {\r\n        return new FormFields(prop.set(this.options, 'defaults', defaults || {}));\r\n    };\r\n    FormFields.prototype.update = function (key, field) {\r\n        var fieldKey = sanitizeKey(key);\r\n        return new FormFields(prop.set(this.options, \"fields.\" + fieldKey, field));\r\n    };\r\n    return FormFields;\r\n}());\r\nexport default FormFields;\r\n//# sourceMappingURL=FormFields.js.map","map":"{\"version\":3,\"file\":\"FormFields.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../src/data/FormFields.tsx\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/matt/Documents/Personal/react-ferms/data/FormFields.d.ts","writeByteOrderMark":false,"text":"import FormField from 'data/FormField';\r\nimport { AddFieldOpts, FormFieldsOptions, FormFieldsValidation, FormStatus, MapStringAny, TransformFn, ValidateOnOpts, ValidationResults, ValidationStrategy } from 'types';\r\nexport default class FormFields {\r\n    private options;\r\n    constructor(opts: FormFieldsOptions);\r\n    add(opts: AddFieldOpts): FormFields;\r\n    remove(key: string): FormFields;\r\n    validate(): FormFieldsValidation;\r\n    validateField(key: string): FormFieldsValidation;\r\n    getField(key: string): FormField;\r\n    readonly values: MapStringAny;\r\n    readonly status: FormStatus;\r\n    readonly errors: {\r\n        [key: string]: ValidationResults;\r\n    };\r\n    setValue(key: string, value: string): FormFields;\r\n    setTransform(key: string, transformFn: TransformFn): FormFields;\r\n    setValidation(key: string, validation: any): FormFields;\r\n    setValidateOn(key: string, on: ValidateOnOpts): FormFields;\r\n    setValidationStrategy(validationStrategy: ValidationStrategy): FormFields;\r\n    setDefaultValidateOn(validateOn: ValidateOnOpts): FormFields;\r\n    setDefaults(defaults: MapStringAny): FormFields;\r\n    private update;\r\n}\r\n"}}
